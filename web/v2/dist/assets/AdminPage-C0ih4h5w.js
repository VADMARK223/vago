import{C as e,E as t,S as n,a as r,c as i,d as a,f as o,l as s,o as c,r as l,s as u,t as d,u as f,w as p}from"./index-Bq2dIKaj.js";function m(e,{successFallback:n=`Успешное удаление`,errorFallback:r,invalidateQueryKeys:o=[]}){let{message:c}=t.useApp(),l=a(),{mutate:u,isPending:d}=s({mutationFn:e,onSuccess:async e=>{c.success(e?.message??n),await Promise.all(o.map(e=>l.invalidateQueries({queryKey:e})))},onError:async e=>{let t=await i(e);c.error(t??r)}});return{mutate:u,isPending:d}}const h=()=>f({queryKey:[c.USERS],queryFn:async()=>(await u.get(r.USERS).json()).data}),g=()=>f({queryKey:[c.MESSAGES],queryFn:async()=>(await u.get(r.MESSAGES).json()).data});var _=async e=>u.delete(`${r.USERS}/${e}`).json();const v=()=>m(_,{errorFallback:`Ошибка удаления пользователя`,successFallback:`Пользователь удалён`,invalidateQueryKeys:[[c.USERS]]});var y=async e=>u.delete(`${r.MESSAGES}/${e}`).json();const b=()=>m(y,{errorFallback:`Ошибка удаления сообщения`,successFallback:`Сообщение удалёно`,invalidateQueryKeys:[[c.MESSAGES]]});var x=o();const S=({onClick:e,loading:t})=>(0,x.jsx)(p,{type:`primary`,danger:!0,onClick:e,loading:t,size:`large`,icon:(0,x.jsx)(n,{})});function C({id:e}){let{mutate:t,isPending:n}=v();return(0,x.jsx)(S,{onClick:()=>t(e),loading:n})}function w(){let{data:e,isLoading:t,isError:n}=h(),r=e?.users??[];return t?(0,x.jsx)(`div`,{children:`Loading...`}):n?(0,x.jsx)(`div`,{children:`Error`}):r.length?(0,x.jsx)(d,{children:(0,x.jsx)(`div`,{className:`stack`,children:r.map(e=>(0,x.jsxs)(`div`,{className:`panel`,children:[(0,x.jsxs)(`div`,{children:[(0,x.jsxs)(`h2`,{children:[`ID: `,e.id]}),(0,x.jsxs)(`span`,{children:[`Username: `,e.username]}),(0,x.jsx)(`br`,{}),(0,x.jsxs)(`span`,{children:[`Login: `,e.login]}),(0,x.jsx)(`br`,{}),(0,x.jsxs)(`span`,{children:[`Role: `,e.role]})]}),(0,x.jsx)(C,{id:e.id})]},e.id))})}):(0,x.jsx)(`div`,{children:`No users found`})}const T=({id:e})=>{let{mutate:t,isPending:n}=b();return(0,x.jsx)(S,{onClick:()=>t(e),loading:n})};var E=[{key:`users`,label:`Пользователи`,children:(0,x.jsx)(w,{})},{key:`messages`,label:`Сообщения`,children:(0,x.jsx)(()=>{let{data:e,isLoading:t,isError:n}=g(),r=e?.messages??[];return t?(0,x.jsx)(`div`,{children:`Loading...`}):n?(0,x.jsx)(`div`,{children:`Error`}):r.length?(0,x.jsx)(d,{children:(0,x.jsx)(`div`,{className:`stack`,children:r.map(e=>(0,x.jsxs)(`div`,{className:`panel`,children:[(0,x.jsxs)(`div`,{children:[(0,x.jsxs)(`h3`,{children:[`ID: `,e.id]}),(0,x.jsxs)(`div`,{children:[`Username: `,e.username,` (Id: `,e.authorId,`)`]}),(0,x.jsxs)(`div`,{children:[`Body: `,(0,x.jsx)(`b`,{children:e.body})]}),(0,x.jsxs)(`div`,{children:[`Type: `,e.type]}),(0,x.jsxs)(`div`,{children:[`Sent at: `,e.sentAt]})]}),(0,x.jsx)(T,{id:e.id})]},e.id))})}):(0,x.jsx)(`div`,{children:`Сообщений нет`})},{})},{key:`comments`,label:`Комментарии`,children:`Комментарии`,disabled:!0}],D=e=>e===`users`||e===`messages`;const O=()=>{let t=l(e=>e.adminTabKey),n=l(e=>e.setAdminTabKey);return(0,x.jsx)(`div`,{className:`tabs-page`,children:(0,x.jsx)(e,{activeKey:t,items:E,onChange:e=>{D(e)&&n(e)}})})};export{O as AdminPage};