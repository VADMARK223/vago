{{ define "header" }}
<header>
    <h2>{{.capture}}</h2>
    <div class="menu">
        <div>
            {{ template "component.href_btn" dict
            "Href" "/"
            "Icon" "fa-solid fa-house"
            "Path" .Path
            }}

            {{ template "component.href_btn" dict
            "Href" "/test"
            "Name" "–¢–µ—Å—Ç"
            "Icon" "fa-solid fa-check-double"
            "Path" .Path
            }}

            {{ template "component.href_btn" dict
            "Href" "/book"
            "Name" "–ö–Ω–∏–≥–∞"
            "Icon" "fa-solid fa-book"
            "Path" .Path
            }}


            {{ template "component.href_btn" dict
            "Href" "/tasks"
            "Name" "–ó–∞–¥–∞—á–∏"
            "Icon" "fa-solid fa-list-check"
            "Disabled" (not .user_id)
            "Path" .Path
            }}

            {{ template "component.href_btn" dict
            "Href" "/chat"
            "Name" "–ß–∞—Ç"
            "Icon" "fa-solid fa-comment"
            "Disabled" (not .user_id)
            "Path" .Path
            }}

            {{ template "component.href_btn" dict
            "Href" "/questions"
            "Name" "–í–æ–ø—Ä–æ—Å—ã"
            "Icon" "fa-solid fa-circle-question"
            "Path" .Path
            }}

            {{if .user_id}}
            {{if .is_admin}}
            <span>
                {{ template "component.href_btn" dict
                "Href" "/add_questions"
                "Icon" "fa-solid fa-plus"
                "Path" .Path
                }}

                {{ template "component.href_btn" dict
                "Href" "/admin"
                "Icon" "fa-solid fa-screwdriver-wrench"
                "Path" .Path
                }}
            </span>

            {{end}}
            {{end}}
        </div>

        <div>
            <span class="greetings">{{.username}}!</span>
            {{if .user_id}}
            <form action="/logout" method="POST" style="display:inline;">
                <button class="btn btn-primary" id="logBtn">
                    <i class="fa-solid fa-arrow-right-from-bracket"></i>
                </button>
            </form>
            {{else}}
            <form action="/login" method="GET" style="display:inline;">
                <button class="btn btn-primary">
                    <i class="fa-solid fa-arrow-right-to-bracket"></i>
                </button>
            </form>
            {{end}}
        </div>
    </div>

    <script>
        (function () {
            const header = document.querySelector("header");
            if (!header) return;

            const SNOWFLAKES = ["‚ùÑ", "‚ùÖ", "‚ùÜ"];
            const MAX_SNOW = 160;

            function createSnowflake() {
                if (header.querySelectorAll(".snowflake").length > MAX_SNOW) return;

                const snow = document.createElement("div");
                snow.className = "snowflake";
                snow.textContent = SNOWFLAKES[Math.floor(Math.random() * SNOWFLAKES.length)];

                const size = 10 + Math.random() * 14;
                const fallDuration = 2 + Math.random() * 3;
                const spinDuration = 1 + Math.random() * 2;

                // üå¨Ô∏è –≤–µ—Ç–µ—Ä: –æ—Ç -60 –¥–æ +60 px
                const windX = (Math.random() * 120 - 60).toFixed(1);

                snow.style.left = Math.random() * header.offsetWidth + "px";
                snow.style.fontSize = size + "px";
                snow.style.setProperty("--wind-x", windX + "px");

                snow.style.animationDuration =
                    `${fallDuration}s, ${1 + Math.random() * 2}s, ${spinDuration}s, ${fallDuration}s`;

                snow.style.animationDirection =
                    `normal, alternate, ${Math.random() > 0.5 ? "normal" : "reverse"}, normal`;

                header.appendChild(snow);

                setTimeout(() => snow.remove(), fallDuration * 1000);
            }

            setInterval(() => {
                for (let i = 0; i < 4; i++) {
                    createSnowflake();
                }
            }, 120);
        })();
    </script>

</header>
{{ end }}