<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Quiz</title>
    <link rel="stylesheet" href="/static/css/index.css">
</head>
<body>
{{ template "header" . }}

<main>
    <div class="container">
        <h2>{{.question.Text}}</h2>

        <div class="answers" id="answers">
            {{range .question.Answers}}
            <button class="answer" data-id="{{.ID}}">
                {{.Text}}
            </button>
            {{end}}
        </div>

        <p id="result" class="hidden"></p>

    </div>
</main>

{{ template "footer" . }}

<script>
    const questionID = "{{.question.ID}}";
    console.log("Question ID", questionID)
    const buttons = document.querySelectorAll(".answer");
    const result = document.getElementById("result");

    buttons.forEach(btn => {
        btn.addEventListener("click", async () => {
            const answerID = Number(btn.dataset.id);

            const resp = await fetch("/quiz/check", {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({
                    question_id: Number(questionID),
                    answer_id: answerID
                })
            });
            const data = await resp.json();

            if (data.correct) {
                btn.classList.add("correct");
                result.innerText = "–ü—Ä–∞–≤–∏–ª—å–Ω–æ!";
                result.classList.remove("hidden");
                result.classList.add("ok");
            } else {
                btn.classList.add("wrong");
                result.innerText = "–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ üòû";
                result.classList.remove("hidden");
                result.classList.add("bad");
            }
        });
    });
</script>

</body>
</html>